<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Code Runner</title>
  <style>
    body {
      background-color: #1e1e1e;
      color: #d4d4d4;
      font-family: Consolas, monospace;
      padding: 20px;
    }

    textarea {
      width: 100%;
      height: 300px;
      background-color: #1e1e1e;
      color: #d4d4d4;
      border: 1px solid #555;
      border-radius: 5px;
      padding: 10px;
      font-size: 14px;
      resize: vertical;
    }

    button, input {
      margin-top: 10px;
      padding: 10px;
      font-size: 14px;
      border-radius: 5px;
      border: none;
    }

    button {
      background-color: #007acc;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #005fa3;
    }

    input[type="text"] {
      width: 150px;
      margin-left: 10px;
      background-color: #252526;
      color: #d4d4d4;
      border: 1px solid #555;
    }

    iframe {
      margin-top: 20px;
      width: 100%;
      height: 300px;
      border: 1px solid #555;
      border-radius: 5px;
      background: white;
    }
  </style>
</head>
<body>

  <h2>Code Runner</h2>

  <textarea id="editor" placeholder="Write your HTML/JS here..."></textarea><br>

  <button onclick="runCode()">Run</button>
  <button onclick="saveCode()">Save Code</button>

  <input type="text" id="loadCodeInput" placeholder="Enter code to load">
  <button onclick="loadCode()">Load Code</button>

  <iframe id="preview"></iframe>

  <script>
    function generateCode(length = 4) {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      let code = '';
      for (let i = 0; i < length; i++) {
        code += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return code;
    }

    function runCode() {
      const code = document.getElementById('editor').value;
      const iframe = document.getElementById('preview');
      iframe.srcdoc = code;
    }

    function saveCode() {
      const codeContent = document.getElementById('editor').value;
      const code = generateCode();

      fetch(`https://code-runner-ae31e-default-rtdb.firebaseio.com/snippets/${code}.json`, {
        method: 'PUT',
        body: JSON.stringify({ code: codeContent })
      }).then(() => {
        alert(`✅ Code saved! Your code is: ${code}`);
      });
    }

    function loadCode() {
      const code = document.getElementById('loadCodeInput').value.toUpperCase();

      fetch(`https://code-runner-ae31e-default-rtdb.firebaseio.com/snippets/${code}.json`)
        .then(res => res.json())
        .then(data => {
          if (data && data.code) {
            document.getElementById('editor').value = data.code;
            runCode();
          } else {
            alert('❌ Code not found.');
          }
        });
    }
  </script>

</body>
</html>